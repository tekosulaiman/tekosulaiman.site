<header class="relative w-full bg-gray-100 shadow-md sticky top-0 left-0 z-50">
  <div class="max-w-4xl mx-auto flex items-center justify-between px-4 py-3">
    <!-- Brand -->
    <a href="{{ SITEURL }}/" class="text-xl font-bold text-gray-800 no-underline">
      {{ SITENAME }}
    </a>

    <!-- Hamburger -->
    <button id="menu-toggle" class="lg:hidden flex flex-col gap-1 p-2 text-gray-700" aria-label="Open menu">
      <span class="w-6 h-0.5 bg-gray-700"></span>
      <span class="w-6 h-0.5 bg-gray-700"></span>
    </button>

    <!-- Desktop Nav -->
    <nav id="desktop-nav" class="hidden lg:flex gap-6 items-center text-sm font-medium text-gray-700">
      <a href="{{ SITEURL }}/management/" class="hover:text-blue-600 no-underline">Management</a>
      <a href="{{ SITEURL }}/analysis/" class="hover:text-blue-600 no-underline">Analysis</a>
      <a href="{{ SITEURL }}/documentation/" class="hover:text-blue-600 no-underline">Documentation</a>
      <a href="{{ SITEURL }}/technical/" class="hover:text-blue-600 no-underline">Technical</a>
      <a href="{{ SITEURL }}/about/" class="hover:text-blue-600 no-underline">About</a>
      <a href="{{ SITEURL }}/resume/" class="hover:text-blue-600 no-underline">Resume</a>
    </nav>
  </div>

  <!-- Mobile Nav -->
  <div id="mobile-menu"
       class="hidden lg:hidden bg-gray-50 text-gray-800 absolute top-full left-0 w-full shadow-md
              transform transition-transform duration-300 ease-in-out -translate-y-4 opacity-0">
    <div class="max-w-4xl mx-auto flex flex-col px-4 py-2 text-sm font-medium">
      <a href="{{ SITEURL }}/management/" class="py-2 no-underline hover:text-blue-600">Management</a>
      <a href="{{ SITEURL }}/analysis/" class="py-2 no-underline hover:text-blue-600">Analysis</a>
      <a href="{{ SITEURL }}/documentation/" class="py-2 no-underline hover:text-blue-600">Documentation</a>
      <a href="{{ SITEURL }}/technical/" class="py-2 no-underline hover:text-blue-600">Technical</a>
      <a href="{{ SITEURL }}/about/" class="py-2 no-underline hover:text-blue-600">About</a>
      <a href="{{ SITEURL }}/resume/" class="py-2 no-underline hover:text-blue-600">Resume</a>
    </div>
  </div>
</header>

<script>
document.addEventListener("DOMContentLoaded", () => {
  const toggle = document.getElementById("menu-toggle");
  const mobileMenu = document.getElementById("mobile-menu");
  const desktopNav = document.getElementById("desktop-nav");

  const mq = window.matchMedia("(max-width: 1023px)");
  let isBound = false;

  function bindMobileToggle() {
    if (!toggle || !mobileMenu || isBound) return;

    mobileMenu.classList.add("hidden");

    toggle.addEventListener("click", () => {
      mobileMenu.classList.toggle("hidden");
    });

    isBound = true;
  }

  function unbindMobileToggle() {
    if (!toggle || !isBound) return;

    const clone = toggle.cloneNode(true);
    toggle.parentNode.replaceChild(clone, toggle);

    isBound = false;
  }

  function handleViewport(e) {
    if (e.matches) {
      // MOBILE
      bindMobileToggle();
      if (desktopNav) {
        desktopNav.querySelectorAll("a").forEach(link => link.remove());
      }
    } else {
      // DESKTOP
      unbindMobileToggle();
      if (mobileMenu) {
        mobileMenu.classList.add("hidden");
        mobileMenu.querySelectorAll("a").forEach(link => link.remove());
      }
    }
  }

  handleViewport(mq);
  mq.addEventListener("change", handleViewport);
});
</script>
